{"ast":null,"code":"import * as d3 from 'd3';\nimport { find_path } from 'dijkstrajs';\nimport { colors } from '../config/config';\nexport const findShortestPath = (graph, system1, system2, highlightPath) => {\n  if (system1 === 'rect1' || system2 === 'rect1') {\n    console.error('Invalid system selection for pathfinding:', system1, system2);\n    return;\n  }\n  console.log('Graph Data:', graph);\n  const graphNodes = {};\n  graph.edges.forEach(edge => {\n    if (!graphNodes[edge.start]) graphNodes[edge.start] = {};\n    if (!graphNodes[edge.end]) graphNodes[edge.end] = {};\n    graphNodes[edge.start][edge.end] = edge.distance;\n    graphNodes[edge.end][edge.start] = edge.distance;\n  });\n  console.log('Constructed Graph Nodes:', graphNodes);\n  try {\n    const path = find_path(graphNodes, system1, system2);\n    highlightPath(path);\n  } catch (error) {\n    console.error('Error finding path:', error);\n  }\n};\n\n// Function to highlight the path\nexport const highlightPath = path => {\n  // Reset all system nodes color and stroke except the background rect\n  d3.selectAll('rect').each(function () {\n    if (d3.select(this).attr('id') !== 'rect1') {\n      d3.select(this).attr('fill', colors.resetSystemFill).attr('fill-opacity', colors.resetSystemFillOpacity).attr('stroke', colors.resetSystemStroke).attr('stroke-width', colors.resetSystemStrokeWidth);\n    }\n  });\n\n  // Reset all paths color and stroke\n  d3.selectAll('path').each(function () {\n    d3.select(this).attr('stroke', colors.resetPathStroke).attr('stroke-width', colors.resetPathStrokeWidth);\n  });\n\n  // Highlight systems in the path\n  path.forEach(system => {\n    d3.select(`#${CSS.escape(system)}`).attr('fill', colors.systemFill).attr('stroke', colors.systemStroke);\n  });\n\n  // Highlight paths in the path\n  for (let i = 0; i < path.length - 1; i++) {\n    const start = path[i];\n    const end = path[i + 1];\n    d3.selectAll(`path[id*=\"${start}\"][id*=\"${end}\"], path[id*=\"${end}\"][id*=\"${start}\"]`).attr('stroke', colors.pathStroke).attr('stroke-width', colors.pathStrokeWidth);\n  }\n\n  // Ensure the start and end systems of the path are highlighted\n  if (path.length >= 2) {\n    const startSystem = path[0];\n    const endSystem = path[path.length - 1];\n    highlightSelectedSystem(null, startSystem, [startSystem, endSystem]);\n    highlightSelectedSystem(null, endSystem, [startSystem, endSystem]);\n  }\n};\nexport const highlightSelectedSystem = (prevSelectedSystem, nextSelectedSystem, pathfindingSelection) => {\n  // Reset previous system node color and stroke if it's not part of pathfinding selection\n  console.log(\"prev:\", prevSelectedSystem);\n  console.log(\"next:\", nextSelectedSystem);\n  console.log(\"path\", pathfindingSelection);\n  if (prevSelectedSystem && !pathfindingSelection.includes(prevSelectedSystem)) {\n    const prevSystemNode = d3.select(`#${CSS.escape(prevSelectedSystem)}`);\n    if (!prevSystemNode.empty()) {\n      prevSystemNode.attr('fill', colors.resetSystemFill).attr('fill-opacity', colors.resetSystemFillOpacity).attr('stroke', colors.resetSystemStroke).attr('stroke-width', colors.resetSystemStrokeWidth);\n    }\n  }\n\n  // Set new system node color and stroke\n  if (nextSelectedSystem) {\n    const nextSystemNode = d3.select(`#${CSS.escape(nextSelectedSystem)}`);\n    if (!nextSystemNode.empty()) {\n      nextSystemNode.attr('fill', colors.systemFill).attr('stroke', colors.systemStroke).attr('stroke-width', colors.systemStrokeWidth);\n    }\n  }\n\n  // Ensure pathfinding selection remains highlighted\n  pathfindingSelection.forEach(system => {\n    const systemNode = d3.select(`#${CSS.escape(system)}`);\n    if (!systemNode.empty()) {\n      systemNode.attr('fill', colors.systemFill).attr('stroke', colors.systemStroke).attr('stroke-width', colors.systemStrokeWidth);\n    }\n  });\n};","map":{"version":3,"names":["d3","find_path","colors","findShortestPath","graph","system1","system2","highlightPath","console","error","log","graphNodes","edges","forEach","edge","start","end","distance","path","selectAll","each","select","attr","resetSystemFill","resetSystemFillOpacity","resetSystemStroke","resetSystemStrokeWidth","resetPathStroke","resetPathStrokeWidth","system","CSS","escape","systemFill","systemStroke","i","length","pathStroke","pathStrokeWidth","startSystem","endSystem","highlightSelectedSystem","prevSelectedSystem","nextSelectedSystem","pathfindingSelection","includes","prevSystemNode","empty","nextSystemNode","systemStrokeWidth","systemNode"],"sources":["/home/admin_user/PycharmProjects/StarMap_PrUn/prun-universe-map/src/utils/graphUtils.js"],"sourcesContent":["import * as d3 from 'd3';\nimport { find_path } from 'dijkstrajs';\nimport { colors } from '../config/config';\n\nexport const findShortestPath = (graph, system1, system2, highlightPath) => {\n  if (system1 === 'rect1' || system2 === 'rect1') {\n    console.error('Invalid system selection for pathfinding:', system1, system2);\n    return;\n  }\n\n  console.log('Graph Data:', graph);\n\n  const graphNodes = {};\n  graph.edges.forEach(edge => {\n    if (!graphNodes[edge.start]) graphNodes[edge.start] = {};\n    if (!graphNodes[edge.end]) graphNodes[edge.end] = {};\n    graphNodes[edge.start][edge.end] = edge.distance;\n    graphNodes[edge.end][edge.start] = edge.distance;\n  });\n\n  console.log('Constructed Graph Nodes:', graphNodes);\n\n  try {\n    const path = find_path(graphNodes, system1, system2);\n    highlightPath(path);\n  } catch (error) {\n    console.error('Error finding path:', error);\n  }\n};\n\n// Function to highlight the path\nexport const highlightPath = (path) => {\n  // Reset all system nodes color and stroke except the background rect\n  d3.selectAll('rect').each(function() {\n    if (d3.select(this).attr('id') !== 'rect1') {\n      d3.select(this)\n        .attr('fill', colors.resetSystemFill)\n        .attr('fill-opacity', colors.resetSystemFillOpacity)\n        .attr('stroke', colors.resetSystemStroke)\n        .attr('stroke-width', colors.resetSystemStrokeWidth);\n    }\n  });\n\n  // Reset all paths color and stroke\n  d3.selectAll('path').each(function() {\n    d3.select(this)\n      .attr('stroke', colors.resetPathStroke)\n      .attr('stroke-width', colors.resetPathStrokeWidth);\n  });\n\n  // Highlight systems in the path\n  path.forEach(system => {\n    d3.select(`#${CSS.escape(system)}`)\n      .attr('fill', colors.systemFill)\n      .attr('stroke', colors.systemStroke);\n  });\n\n  // Highlight paths in the path\n  for (let i = 0; i < path.length - 1; i++) {\n    const start = path[i];\n    const end = path[i + 1];\n\n    d3.selectAll(`path[id*=\"${start}\"][id*=\"${end}\"], path[id*=\"${end}\"][id*=\"${start}\"]`)\n      .attr('stroke', colors.pathStroke)\n      .attr('stroke-width', colors.pathStrokeWidth);\n  }\n\n  // Ensure the start and end systems of the path are highlighted\n  if (path.length >= 2) {\n    const startSystem = path[0];\n    const endSystem = path[path.length - 1];\n    highlightSelectedSystem(null, startSystem, [startSystem, endSystem]);\n    highlightSelectedSystem(null, endSystem, [startSystem, endSystem]);\n  }\n};\n\nexport const highlightSelectedSystem = (prevSelectedSystem, nextSelectedSystem, pathfindingSelection) => {\n  // Reset previous system node color and stroke if it's not part of pathfinding selection\n  console.log(\"prev:\", prevSelectedSystem)\n  console.log(\"next:\", nextSelectedSystem)\n  console.log(\"path\", pathfindingSelection)\n  if (prevSelectedSystem && !pathfindingSelection.includes(prevSelectedSystem)) {\n    const prevSystemNode = d3.select(`#${CSS.escape(prevSelectedSystem)}`);\n    if (!prevSystemNode.empty()) {\n      prevSystemNode\n        .attr('fill', colors.resetSystemFill)\n        .attr('fill-opacity', colors.resetSystemFillOpacity)\n        .attr('stroke', colors.resetSystemStroke)\n        .attr('stroke-width', colors.resetSystemStrokeWidth);\n    }\n  }\n\n  // Set new system node color and stroke\n  if (nextSelectedSystem) {\n    const nextSystemNode = d3.select(`#${CSS.escape(nextSelectedSystem)}`);\n    if (!nextSystemNode.empty()) {\n      nextSystemNode\n        .attr('fill', colors.systemFill)\n        .attr('stroke', colors.systemStroke)\n        .attr('stroke-width', colors.systemStrokeWidth);\n    }\n  }\n\n  // Ensure pathfinding selection remains highlighted\n  pathfindingSelection.forEach(system => {\n    const systemNode = d3.select(`#${CSS.escape(system)}`);\n    if (!systemNode.empty()) {\n      systemNode\n        .attr('fill', colors.systemFill)\n        .attr('stroke', colors.systemStroke)\n        .attr('stroke-width', colors.systemStrokeWidth);\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}